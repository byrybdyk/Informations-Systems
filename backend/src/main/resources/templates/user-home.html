<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Home</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <style>
        .table-container {
            width: 100%;
            max-height: 400px;
            overflow: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
            padding-top: 60px;
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>


    <script th:inline="javascript">

    </script>
</head>

<body>
<h1>Welcome, <span th:text="${username}" id="userName">User</span>!</h1>
<p>This is the user area.</p>

<button onclick="openFormModal()">Add Lab Work</button>

<div id="labWorkModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 id="modalTitle">Add Lab Work</h2>
        <form id="labWorkForm" onsubmit="handleSubmit(event, document.getElementById('labWorkId').value)">
            <input type="hidden" id="labWorkId" name="id">

            <label for="name">Lab Work Name:</label>
            <input
                    type="text"
                    name="name"
                    id="labWorkName"
                    placeholder="Lab Work Name"
                    required
                    minlength="1"
            >

            <label for="coordinatesId">Coordinates:</label>
            <select name="coordinatesId" id="coordinatesId" onchange="toggleCreateCoordinates()" required>
                <option value="">-- Select Coordinates --</option>
            </select>
            <button type="button" onclick="createNewCoordinates()">Create New Coordinates</button>
            <div id="newCoordinatesFields" style="display:none;">
                <input
                        type="number"
                        name="newCoordinatesX"
                        placeholder="New Coordinates X"
                        step="any"
                >
                <input
                        type="number"
                        name="newCoordinatesY"
                        placeholder="New Coordinates Y"
                        step="1"
                >
            </div>

            <label for="description">Description:</label>
            <input
                    type="text"
                    name="description"
                    id="labWorkDescription"
                    placeholder="Description"
                    minlength="1"
                    required
            >

            <label for="difficulty">Difficulty:</label>
            <select name="difficulty" id="labWorkDifficulty" required>
                <option value="">-- Select Difficulty --</option>
                <option value="VERY_EASY">VERY_EASY</option>
                <option value="HARD">HARD</option>
                <option value="INSANE">INSANE</option>
            </select>

            <label for="disciplineId">Discipline:</label>
            <select name="disciplineId" id="disciplineId" onchange="toggleCreateDiscipline()" required>
                <option value="">-- Select Discipline --</option>
            </select>
            <button type="button" onclick="createNewDiscipline()">Create New Discipline</button>
            <div id="newDisciplineFields" style="display:none;">
                <input
                        type="text"
                        name="newDisciplineName"
                        placeholder="New Discipline Name"
                >
                <input
                        type="number"
                        name="newPracticeHours"
                        placeholder="Practice Hours"
                        step="1"
                >
            </div>

            <label for="minimal_point">Minimal Point:</label>
            <input
                    type="number"
                    name="minimalPoint"
                    id="minimalPoint"
                    placeholder="Minimal Point"
                    required
                    step="any"
            >

            <label for="personal_qualities_minimum">Personal Qualities Minimum:</label>
            <input
                    type="number"
                    name="personalQualitiesMinimum"
                    id="personalQualitiesMinimum"
                    placeholder="Personal Qualities Minimum"
                    required
                    step="any"
            >

            <label for="personal_qualities_maximum">Personal Qualities Maximum:</label>
            <input
                    type="number"
                    name="personalQualitiesMaximum"
                    id="personalQualitiesMaximum"
                    placeholder="Personal Qualities Maximum"
                    required
                    step="any"
            >

            <label for="authorId">Author:</label>
            <select name="authorId" id="authorId" onchange="toggleCreateAuthor()" required>
                <option value="">-- Select Author --</option>
            </select>
            <button type="button" onclick="createNewAuthor()">Create New Author</button>
            <div id="newAuthorFields" style="display:none;">
                <input
                        type="text"
                        name="newAuthorName"
                        placeholder="New Author Name"
                >
                <input
                        type="number"
                        name="newAuthorWeight"
                        placeholder="Author Weight"
                        step="any"
                >
                <label for="newAuthorEyeColor">Eye Color:</label>
                <select name="newAuthorEyeColor" id="newAuthorEyeColor">
                    <option value="WHITE">WHITE</option>
                    <option value="ORANGE">ORANGE</option>
                    <option value="BLACK">BLACK</option>
                    <option value="YELLOW">YELLOW</option>
                    <option value="BROWN">BROWN</option>
                </select>
                <label for="newAuthorHairColor">Hair Color:</label>
                <select name="newAuthorHairColor" id="newAuthorHairColor">
                    <option value="WHITE">WHITE</option>
                    <option value="ORANGE">ORANGE</option>
                    <option value="BLACK">BLACK</option>
                    <option value="YELLOW">YELLOW</option>
                    <option value="BROWN">BROWN</option>
                </select>
                <input
                        type="number"
                        name="passportID"
                        placeholder="Passport ID"
                        step="1"
                >
                <label for="locationId">Location:</label>
                <select name="locationId" id="locationId" onchange="toggleCreateLocation()">
                    <option value="">-- Select Location --</option>
                </select>
                <button type="button" onclick="createNewLocation()">Create New Location</button>
                <div id="newLocationFields" style="display:none;">
                    <input
                            type="number"
                            name="newLocationX"
                            placeholder="New Location X"
                            step="any"
                    >
                    <input
                            type="number"
                            name="newLocationY"
                            placeholder="New Location Y"
                            step="any"
                    >
                    <input
                            type="text"
                            name="newLocationName"
                            placeholder="New Location Name"
                    >
                </div>
                <input type="hidden" id="ownerField" name="ownerField">
            </div>

            <button type="submit" id="submitButton" name="action" value="add">Add Lab Work</button>
        </form>
    </div>
</div>

<br>

<div>
    <input type="text" id="filterId" placeholder="Filter by ID" oninput="applyFilters()">
    <input type="text" id="filterOwnerUsername" placeholder="Filter by Owner Username" oninput="applyFilters()">
    <input type="text" id="filterCreationDate" placeholder="Filter by Creation Date" oninput="applyFilters()">
    <input type="text" id="filterName" placeholder="Filter by Name" oninput="applyFilters()">
    <input type="text" id="filterDisciplineName" placeholder="Filter by Discipline Name" oninput="applyFilters()">
    <input type="text" id="filterDisciplinePracticeHours" placeholder="Filter by Practice Hours" oninput="applyFilters()">
    <input type="text" id="filterDescription" placeholder="Filter by Description" oninput="applyFilters()">
    <input type="text" id="filterDifficulty" placeholder="Filter by Difficulty" oninput="applyFilters()">
    <input type="text" id="filterCoordinatesX" placeholder="Filter by Coordinates X" oninput="applyFilters()">
    <input type="text" id="filterCoordinatesY" placeholder="Filter by Coordinates Y" oninput="applyFilters()">
    <input type="text" id="filterMinimalPoint" placeholder="Filter by Minimal Point" oninput="applyFilters()">
    <input type="text" id="filterPersonalQualitiesMaximum" placeholder="Filter by Personal Qualities Max" oninput="applyFilters()">
    <input type="text" id="filterPersonalQualitiesMinimum" placeholder="Filter by Personal Qualities Min" oninput="applyFilters()">
    <input type="text" id="filterAuthorName" placeholder="Filter by Author Name" oninput="applyFilters()">
    <input type="text" id="filterAuthorWeight" placeholder="Filter by Author Weight" oninput="applyFilters()">
    <input type="text" id="filterAuthorEyeColor" placeholder="Filter by Author Eye Color" oninput="applyFilters()">
    <input type="text" id="filterAuthorHairColor" placeholder="Filter by Author Hair Color" oninput="applyFilters()">
    <input type="text" id="filterAuthorLocationX" placeholder="Filter by Location X" oninput="applyFilters()">
    <input type="text" id="filterAuthorLocationY" placeholder="Filter by Location Y" oninput="applyFilters()">
    <input type="text" id="filterAuthorLocationName" placeholder="Filter by Location Name" oninput="applyFilters()">
    <input type="text" id="filterAuthorPassportID" placeholder="Filter by Passport ID" oninput="applyFilters()">
    <button onclick="clearFilters()">Clear Filters</button>
</div>


<h2>LabWork Entities</h2>
<div class="table-container">
    <table id="labWorkTable">
        <thead>
        <tr>
            <th onclick="applySorting('id')">ID</th>
            <th onclick="applySorting('ownerUsername')">Owner</th>
            <th onclick="applySorting('creationDate')">Creation Date</th>
            <th onclick="applySorting('name')">Name</th>
            <th onclick="applySorting('disciplineName')">Discipline Name</th>
            <th onclick="applySorting('disciplinePracticeHours')">Practice Hours</th>
            <th onclick="applySorting('description')">Description</th>
            <th onclick="applySorting('difficulty')">Difficulty</th>
            <th onclick="applySorting('coordinatesX')">Coordinates X</th>
            <th onclick="applySorting('coordinatesY')">Coordinates Y</th>
            <th onclick="applySorting('minimalPoint')">Minimal Point</th>
            <th onclick="applySorting('personalQualitiesMaximum')">Personal Qualities Max</th>
            <th onclick="applySorting('personalQualitiesMinimum')">Personal Qualities Min</th>
            <th onclick="applySorting('authorName')">Author Name</th>
            <th onclick="applySorting('authorWeight')">Author Weight</th>
            <th onclick="applySorting('authorEyeColor')">Author Eye Color</th>
            <th onclick="applySorting('authorHairColor')">Author Hair Color</th>
            <th onclick="applySorting('authorLocationX')">Location X</th>
            <th onclick="applySorting('authorLocationY')">Location Y</th>
            <th onclick="applySorting('authorLocationName')">Location Name</th>
            <th onclick="applySorting('authorPassportID')">Passport ID</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody id="labWorkTableBody">
        </tbody>
    </table>
</div>

<div id="pagination">
    <button onclick="previousPage()">Previous</button>
    <span id="currentPage">1</span> / <span id="totalPages">1</span>
    <button onclick="nextPage()">Next</button>
</div>

<a href="/logout">Logout</a>
<script src="/js/scripts.js"></script>
<script src="/js/util.js"></script>
<script src="/js/sorting.js"></script>
<script src="/js/validation.js"></script>
</body>
</html>